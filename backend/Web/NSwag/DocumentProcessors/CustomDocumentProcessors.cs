
using Application.Common.Exceptions.Enums;
using Application.Common.Security;
using NSwag.Generation.Processors;
using NSwag.Generation.Processors.Contexts;

/// <summary>
/// Add missing models / enums to be generated by Nswag.
/// Generally all models connected to Controllers are automatically mapped.
/// </summary>
namespace Web.DocumentProcessors
{
    public class CustomDocumentProcessor : IDocumentProcessor
    {
        public void Process(DocumentProcessorContext context)
        {
            AddTypeToSchema(context, typeof(CommandErrorCode));
            AddTypeToSchema(context, typeof(Domain.Enums.RoleEnum));
            AddTypeToSchema(context, typeof(Scope));
        }

        private void AddTypeToSchema(DocumentProcessorContext context, Type type)
        {
            if (!context.SchemaResolver.HasSchema(type, true))
            {
                context.SchemaGenerator.Generate(type, context.SchemaResolver);
            }
        }
    }
}
